(function(c){var b=false;var d=function(e){if(isNaN(window.scrollX)){return{X:e.clientX+document.documentElement.scrollLeft+document.body.scrollLeft,Y:e.clientY+document.documentElement.scrollTop+document.body.scrollTop}}else{return{X:e.clientX+window.scrollX,Y:e.clientY+window.scrollY}}};var a=function(i,o){var n,e,h,f={X:0,Y:0};var k=function(q){if(!b){return}var p=d(q);if(o.axis!=="y"){f.X=p.X+e.X-h.X;f.X=f.X>0?(f.X<n.clientWidth-i.clientWidth?f.X:n.clientWidth-i.clientWidth):0;i.style.left=f.X+"px"}if(o.axis!=="x"){f.Y=p.Y+e.Y-h.Y;f.Y=f.Y>0?(f.Y<n.clientHeight-i.clientHeight?f.Y:n.clientHeight-i.clientHeight):0;i.style.top=f.Y+"px"}if(o.drag){var r={position:{left:f.X,top:f.Y}};o.drag(q,r)}};var j=function(p){c(document).off(".jDraggable");b=false;if(o.stop){var q={position:{left:f.X,top:f.Y}};o.stop(p,q)}};var m=function(q){var p=this;q.preventDefault();q.stopPropagation();e={X:parseInt(p.style.left||0),Y:parseInt(p.style.top||0)};h=d(q);if(o.start){var r={position:{left:e.X,top:e.Y}};o.start(q,r)}b=true;c(document).on("mousemove.jDraggable",k);c(document).on("mouseup.jDraggable",j)};n=i.parentNode;if(!n.style.position||n.style.position=="static"){n.style.position="relative"}var g=n.getBoundingClientRect(),l=i.getBoundingClientRect();i.style.top=l.top-g.top;i.style.left=l.left-g.left;i.style.position="absolute";c(i).on("mousedown",m)};c.fn.jDraggable=function(e){e=c.extend({},e);return this.each(function(f,g){a(g,e)})}})(jQuery);(function(b){var a=function(g,f){var p=this,t=f.step||5,o=f.interval||10,e=g.closest(".scroller");var d=e.find(".scroller-content-wrapper");d.css("height",g.height());g.addClass("h-scroller");var c=e.find(".scroller-handle"),h=e.find(".scroller-track-wrapper"),v=e.find(".scroller-controls"),k=v.find(".scroller-left"),i=v.find(".scroller-right"),q=g.width(),n=false;var j=function(y){var x=h.width()-c.width(),w=q-d.width();g.css("left",-w*y/x)};var l=function(A){if(A.target!==this){return}var y=h.width(),x=c.width(),z=b(this).offset().left,w=A.pageX-z-x/2;if(x>y-w){w=y-x}else{if(w<0){w=0}}c.css("left",w);j(w)};var s=function(){var w=parseInt(c.css("left"));if(w===0){return}w=w-t<0?0:w-t;c.css("left",w);j(w);p.timeoutId=setTimeout(function(){k.mousedown()},o);b(document).on("mouseup.scroller",m)};var r=function(){var w=parseInt(c.css("left"))+t,x=h.width()-c.width();if(w===x){return}w=w<x?w:x;c.css("left",w);j(w);p.timeoutId=setTimeout(function(){i.mousedown()},o);b(document).on("mouseup",m)};var m=function(){clearTimeout(p.timeoutId);b(document).off("mouseup")};var u=function(){var z=d.width(),y=Math.abs(parseInt(g.css("left"))),x=h.width();if(z>=q){v.css("visibility","hidden");n=false;g.css("left",0);c.css({left:0,display:"none"})}else{if(!n&&z<q){v.css("visibility","visible");n=true}}if(!n){return}if(z+y>q){y=q-z;g.css("left",-y)}var w=x*z/q,A=x*(1-(q-y-z)/q)-w;c.css({display:"block",width:w,left:A})};this.bindEvents=function(){c.jDraggable({axis:"x",containment:"parent",drag:function(w,x){j(x.position.left)}});b(window).on("resize",u).resize();h.on("mousedown",l);k.on("mousedown",s);i.on("mousedown",r)}};b.fn.hScroller=function(c){c=b.extend({},c);return this.each(function(f,g){var e=b(g);if(e.hasClass("h-scroller")){return}else{var d=new a(e,c);d.bindEvents()}})}})(jQuery);+function(i){function l(a){i(h).remove(),i(n).each(function(){var d=k(i(this)),e={relatedTarget:this};if(!d.hasClass("open")){return}d.trigger(a=i.Event("hide.bs.dropdown",e));if(a.isDefaultPrevented()){return}d.removeClass("open").trigger("hidden.bs.dropdown",e)})}function k(a){var f=a.attr("data-target");f||(f=a.attr("href"),f=f&&/#[A-Za-z]/.test(f)&&f.replace(/.*(?=#[^\s]*$)/,""));var e=f&&i(f);return e&&e.length?e:a.parent()}"use strict";var h=".dropdown-backdrop",n="[data-toggle=dropdown]",m=function(a){i(a).on("click.bs.dropdown",this.toggle)};m.prototype.toggle=function(a){var p=i(this);if(p.is(".disabled, :disabled")){return}var o=k(p),f=o.hasClass("open");l();if(!f){"ontouchstart" in document.documentElement&&!o.closest(".navbar-nav").length&&i('<div class="dropdown-backdrop"/>').insertAfter(i(this)).on("click",l);var e={relatedTarget:this};o.trigger(a=i.Event("show.bs.dropdown",e));if(a.isDefaultPrevented()){return}o.toggleClass("open").trigger("shown.bs.dropdown",e),p.focus()}return !1},m.prototype.keydown=function(a){if(!/(38|40|27)/.test(a.keyCode)){return}var r=i(this);a.preventDefault(),a.stopPropagation();if(r.is(".disabled, :disabled")){return}var q=k(r),p=q.hasClass("open");if(!p||p&&a.keyCode==27){return a.which==27&&q.find(n).focus(),r.click()}var o=" li:not(.divider):visible a",f=q.find("[role=menu]"+o+", [role=listbox]"+o);if(!f.length){return}var c=f.index(f.filter(":focus"));a.keyCode==38&&c>0&&c--,a.keyCode==40&&c<f.length-1&&c++,~c||(c=0),f.eq(c).focus()};var j=i.fn.dropdown;i.fn.dropdown=function(a){return this.each(function(){var d=i(this),b=d.data("bs.dropdown");b||d.data("bs.dropdown",b=new m(this)),typeof a=="string"&&b[a].call(d)})},i.fn.dropdown.Constructor=m,i.fn.dropdown.noConflict=function(){return i.fn.dropdown=j,this},i(document).on("click.bs.dropdown.data-api",l).on("click.bs.dropdown.data-api",".dropdown form",function(b){b.stopPropagation()}).on("click.bs.dropdown.data-api",n,m.prototype.toggle).on("keydown.bs.dropdown.data-api",n+", [role=menu], [role=listbox]",m.prototype.keydown)}(jQuery);(function(b){var a=function(d){d=b.extend({className:"j-notify",title:"",escapeMsg:false},d);var c=parseInt(d.delay)||5000,f=null,e=b(_.template(b("#j-notify-item").html())(d));var g=function(){e.fadeOut(300,function(){e.remove()})};e.on("mouseenter",function(){clearTimeout(f)});e.on("mouseleave",function(){f=setTimeout(g,c)});e.on("click",".notify-close",g);e.on("mousedown",g);f=setTimeout(g,c);return e};b.jNotify=function(c){var d=b("#j-notify-container");if(d.length===0){d=b('<div id="j-notify-container"></div>');b("body").append(d)}d.append(new a(c).fadeIn(300))}})(jQuery);(function(c){var a=function(g){var f=null;if(g.type=="mousewheel"){f=(g.originalEvent.wheelDelta*-1)}else{if(g.type=="DOMMouseScroll"){f=40*g.originalEvent.detail}}if(f){g.preventDefault();c(this).scrollTop(f+c(this).scrollTop())}};var d=function(i){var f=null,k=c(window),j=c("#popup"),h=parseInt(j.css("top")),g=k.height()-j.height();if(g<120){if(i.type=="mousewheel"){f=(i.originalEvent.wheelDelta*-1)/120}else{if(i.type=="DOMMouseScroll"){f=i.originalEvent.detail/30}}if(f&&((f>0&&-h+g<100)||(f<0&&h<20))){j.css("top",h-f*25)}}};var b=function(g){g=c.extend({bgColorClass:"black",verticalAlign:"top",content:"",popupClass:"",activeMask:c(),onBeforeClose:"",onClose:"",permanent:false,timeout:0},g);var j=c("#popup"),f=this;this.adjustPosition=function(){var o=c(window),k=o.width(),p=o.height(),n=c("#popup"),l=n.width(),m=n.height();n.css({left:(k-l)/2+"px",top:g.verticalAlign==="top"?"20px":(p-m)/2+"px"})};this.close=function(){if(_.isFunction(g.onBeforeClose)){g.onBeforeClose()}if(g.permanent){return}j.remove();e.remove();c("body").css({"padding-right":"0",overflow:"auto"});if(_.isFunction(g.onClose)){g.onClose()}};this.setContent=function(k){j.empty().append(k);f.adjustPosition()};if(j.length!==0){this.setContent(g.content)}else{var e=c('<div id="popup-mask"></div>'),j=c('<div id="popup">'+g.content+"</div>"),i=c(window),h=c("body");if(g.bgColorClass){e.addClass(g.bgColorClass)}e.append(g.activeMask);if(h.height()-i.height()>0){h.css({"padding-right":"15px",overflow:"hidden"})}if(g.popupClass){j.addClass(g.popupClass)}h.append(e,j);e.on("mousewheel DOMMouseScroll",d);j.on("mousewheel DOMMouseScroll",d)}if(_.isFunction(g.onRender)){g.onRender()}c(window).on("resize",f.adjustPosition).resize();c("#popup-mask").on("click close",f.close);c("#popup-mask").on("mousedown",function(k){k.stopPropagation()});c(document).off("keyup.jpopup").on("keyup.jpopup",function(k){if(k.keyCode==27){f.close()}});if(g.timeout>0){setTimeout(f.close,parseInt(g.timeout))}};c.jPopup=function(e){return new b(e)}})(jQuery);(function(b){var a=function(c){c.off(".errorTooltip").closest(".error-container").find(".error-tooltip").remove()};b.fn.errorTooltip=function(i){var j=this,h=false;a(j);if(i!=="remove"){var d=b('<div class="error-tooltip"></div>'),f=b('<div class="error-tooltip-arrow-bg"></div>'),c=b('<div class="error-tooltip-arrow"></div>');d.append(f,c,i);j.closest(".error-container").append(d);if(!h){h=true;var g=j.outerWidth(),e=d.outerWidth();d.css("left",(g-e)/2);f.css("left",e/2-4);c.css("left",e/2-2);d.on("mouseleave",function(k){if(b(k.relatedTarget).is(j)){return}a(j)})}}return this}})(jQuery);(function(a){var b={};var d=function(f,e){this.$el=f;this.$inputBlock=this.$el.closest(".input");this.$input=this.$inputBlock.find("input");this.$content=f.children();this.$wrap=f.closest(".scroller-wrap");this.$scrollBar=this.$wrap.find(".scroll-bar");this.update();this._bindEvents(e);b.scrollbarMinHeight=e.scrollbarMinHeight},c=null;a.extend(d.prototype,{update:function(){this.reinit();this.updateScrollBar()},reinit:function(){this.$el.css("width","");this.$wrap.css("width","");this._setWidth()},updateScrollBar:function(){var e=this._realScrollScale().toFixed(2)==1;this.$scrollBar.css(e?{display:"none"}:{display:"",top:this.$content.scrollTop()+b.scrollbarMinHeight,height:(this.$el.height()+b.scrollbarMinHeight)*this._scrollScale()+b.scrollbarMinHeight});this.$el.trigger("scroll")},_setWidth:function(){var e=this.$el.outerWidth()-this.$el[0].clientWidth;this.$wrap.css("width",this.$content.outerWidth());this.$el.css("width","+="+e)},_scrollScale:function(){var e=(this.$el.height()-b.scrollbarMinHeight)/this.$content.height();return e<1?e:1},_realScrollScale:function(){var e=this.$el.height()/this.$content.height();return e<1?e:1},_preventSelection:function(){return false},_dragBar:function(k){if(c){var i=k.data.context,g=k.clientY-c,f=g/i._scrollScale(),h=i.$content.height()-i.$scrollBar.outerHeight(),j=i.$el.scrollTop()+f;j=(j<0)?j=0:j;j=(j>h)?h:j;i.$el.scrollTop(j)}c=k.clientY},_bindEvents:function(f){var g=this,h=a(document);this.$el.on("scroll",function(){var i=g.$el.scrollTop()*g._scrollScale();g.$scrollBar.css("top",i)});this.$scrollBar.on("mousedown",function(i){i.stopPropagation();i.preventDefault();h.on("selectstart",this._preventSelection).on("mousemove",{context:g},g._dragBar).one("mouseup blur",function(){c=null;h.off("selectstart",g._preventSelection).off("mousemove",g._dragBar)})});this.$el.on("mousewheel DOMMouseScroll",function(j){j.stopPropagation();var i=null;if(j.type=="mousewheel"){i=(j.originalEvent.wheelDelta*-1)}else{if(j.type=="DOMMouseScroll"){i=40*j.originalEvent.detail}}if(i){j.preventDefault();a(this).scrollTop(i+a(this).scrollTop())}});this.$input.on("mousedown focus",function(i){i.stopPropagation();g.$inputBlock.addClass("open")});a(document).on("mousedown",function(){g.$inputBlock.removeClass("open");g.$input.trigger("blur.custom-scroll")});this.$input.on("keydown",function(i){i.stopPropagation();if(i.keyCode===40){i.preventDefault();g.$wrap.find("li").not(".hidden").first().focus()}if(i.keyCode===27){g.$inputBlock.removeClass("open");g.$input.blur();a(document).trigger("mousedown")}});this.$el.on("keydown","li",function(n){n.stopPropagation();n.preventDefault();var l=a(this),k=l.closest("ul"),m=k.hasClass("row2")||k.hasClass("row3");if(n.keyCode===40){var i=l.nextAll("li").not(".hidden").first();if(m){var i=l.nextAll("li").not(".hidden").first().next().next()}if(i.length>0){i.focus()}}if(n.keyCode===38){var j=l.prevAll("li").not(".hidden").first();if(m){j=l.prevAll("li").not(".hidden").first().prev().prev()}if(j.length>0){j.focus()}else{g.$input.focus()}}if(m){if(n.keyCode===37){var j=l.prevAll("li").not(".hidden").first();if(j.length>0){j.focus()}else{g.$input.focus()}}if(n.keyCode===39){var i=l.nextAll("li").not(".hidden").first();if(i.length>0){i.focus()}}}if(n.keyCode===13){l.blur();l.trigger("mousedown")}});this.$inputBlock.find(".clear-input").on("mousedown",function(j){j.stopPropagation();var i=a(this);g.$input.val("");g.$inputBlock.find("li").removeClass("hidden");g.$el.customScroll("update");setTimeout(function(){g.$input.focus()},0);i.hide();if(_.isFunction(f.onClear)){f.onClear.apply(g.$input[0],arguments)}});if(_.isFunction(f.onSelect)){this.$el.off("mousedown.custom-scroll","li").on("mousedown","li",f.onSelect)}this.$input.off("input.custom-scroll paste.custom-scroll").on("input.custom-scroll paste.custom-scroll",function(){g.$inputBlock.find(".clear-input").toggle(g.$input.val().length>0);if(_.isFunction(f.onInput)){f.onInput.apply(this,arguments)}});if(_.isFunction(f.onFocus)){var e=f.nameSpace?f.nameSpace:"custom-scroll";this.$input.off("focus."+e).on("focus."+e,f.onFocus)}if(_.isFunction(f.onBlur)){var e=f.nameSpace?f.nameSpace:"custom-scroll";this.$input.off("blur."+e).on("blur."+e,f.onBlur)}}});a.fn.customScroll=function(f){var e={onSelect:"",scrollbarMinHeight:""};if(_.isObject(f)){e=a.extend(e,f)}return this.each(function(h,j){var i=a(j);if(!i.data("scrollbar")){i.data("scrollbar",new d(i,e))}var g=i.data("scrollbar");if(_.isString(f)&&a.isFunction(g[f.replace(/^_/,"")])){g[f]()}})}}(jQuery));(function(b){var a=function(f,e){e=b.extend({},e);var g=b(f),d=g.find(".placeholder"),c=g.find(".dropdown"),i=c.find("li"),h=i.filter(".selected");if(h.length>0){d.addClass("selected").find("span").text(h.text())}d.on("click",function(k){k.stopPropagation();if(g.hasClass("open")){j()}else{g.addClass("open");b(document).on("click.dropdown",j)}});i.on("click",function(){d.addClass("selected").find("span").text(b(this).text());i.removeClass("selected");b(this).addClass("selected");if(_.isFunction(e.onSelect)){e.onSelect.apply(null,arguments)}});var j=function(){g.removeClass("open");b(document).off("click.dropdown")}};b.fn.jDropdown=function(c){c=b.extend({},c);return this.each(function(d,e){var f=new a(e,c)})}})(jQuery);var Player=function(b){b=$.extend({},b);var g=null,f=null,c=false,d=false,h=0,a=this;this.startPlaying=function(k){var j=$(k.currentTarget),m=j.data("songId"),i=j.data("url"),l=j.closest(".track");if(g){a.stopPlaying()}if(!g||g.id!=m){a.reset(l);f=new e(l);soundManager.onready(function(){g=soundManager.createSound({id:m,url:i,whileloading:function(){f.setBufferedPosition(this.bytesLoaded/this.bytesTotal)},whileplaying:function(){if(!c){c=true;l.addClass("playing");if(b.onReset){b.onReset.call(l[0])}}h=this.durationEstimate;if(!d){f.setProgressPosition(this.position/h)}},onfinish:a.stopPlaying})})}g.play()};this.stopPlaying=function(){var i=$(".playing");g.stop();g.unload();a.reset(i);c=false};this.reset=function(i){if(i.length>0){i.removeClass("playing").find(".buffered-line, .progress-line").css("width",0).end().find(".progress-handle").css("left",0);if(b.onReset){b.onReset.call(i[0])}}};this.rewind=function(j){var i=j.offsetX/$(j.currentTarget).parent().width();g.setPosition(i*h);f.setProgressPosition(i)};this.bindEvents=function(){var i=$(".track:not(.activated)");if(i.length===0){return}i.find(".progress-handle, .play-button, .stop-button, .progress, .btn-green, .qr-code-link").on("mousedown",function(j){j.stopPropagation()});i.find(".progress-handle").jDraggable({axis:"x",containment:"parent",start:function(j,k){d=true},stop:function(k,l){var j=l.position.left/f.getWidth();g.setPosition(j*h);f.setProgressPosition(j);d=false},drag:function(j,k){f.setProgressPosition(k.position.left/f.getWidth())}});i.find(".play-button").on("click",function(j){a.startPlaying(j)});i.find(".stop-button").on("click",function(j){a.stopPlaying()});i.find(".progress").on("mousedown",a.rewind);i.find(".qr-code").click(function(m){m.preventDefault();var k=$(this).closest(".qr-code-link").data("href");var l=_.template($("#qr-popup-tpl").html())({url:k});var j=$.jPopup({content:l})});i.addClass("activated")};var e=function(l){var k=l.find(".progress"),j=l.find(".progress-line"),i=l.find(".buffered-line"),m=l.find(".progress-handle");return{getWidth:function(){return k.width()},setBufferedPosition:function(n){i.css("width",n*k.width())},setProgressPosition:function(n){m.css("left",n*k.width());j.css("width",n*k.width())}}}};var adjustTrackListTitle=function(){var a=$(this).find(".title-block");a.removeClass("resized").css("max-width","");if(a[0].scrollHeight>a.height()){a.css("max-width",a.width()).addClass("resized")}};(function(){$(function(){$(window).on("resize",function(){$(".track").each(adjustTrackListTitle)}).resize();$(document).on("mouseenter mouseleave",".track:not(.playing)",adjustTrackListTitle)});soundManager.setup({url:"http://"+window.location.host+"/swf/",flashVersion:9,debugMode:false,useHTML5Audio:true,flashPollingInterval:10,html5PollingInterval:10});soundManager.onready(function(){window.player=new Player({onReset:adjustTrackListTitle});window.player.bindEvents()})})();(function(B){var e=window.location.href,x=/\/p(\d+)-(?:android|symbian|iphone)-[^/]+\//i,u=1,I=2,b=u;var v=B(document),A=B("body"),F=A.data("cookieDomain"),r=A.data("currentSection"),O={android:true,android_apps:true,sis:true,iphone:true,java:true,ringtone:false,pic:false,wallpaper:true,theme:false},q=O[r],a=new RegExp(F+"/game").test(e);var G=B("<div></div>",{id:"content-shadow"});if(r==="java"||r=="pic"){b=I}if(_.isUndefined(q)){r=""}else{if(O[r]){var t=x.exec(e),E=t?t[1]:0}}var y=function(R){if(!r){return true}if(r==="pic"||r==="wallpaper"||r==="android_apps"){var Q=window.location.href;window.preloader();window.location.href=Q.replace(/size=\d+x\d+[;]?/,"")}else{if(a&&(r===R.platformClass||(R.platformClass==="sis"&&r==="java")||!R.platformClass)){window.preloader();window.location.reload()}else{if(r==="java"&&R.type==="screen"){window.preloader();if(R.links&&R.links.java&&R.links.java.url){window.location.href=R.links.java.url}else{window.location.reload()}}else{if(q){if(R.gamesUrl){window.preloader();window.location.href=R.gamesUrl}else{window.preloader();window.location.reload()}}else{if(r==="theme"){window.preloader();if(R.links&&R.links.theme&&R.links.theme.url){window.location.reload()}else{window.location.reload()}}else{window.preloader();window.location.reload()}}}}}};var i=function(){var T="panel_history",R=B.cookie(T),Q=this;var S=F!=".mob.org"&&F!=".mob.com.de"&&F!=".mob.gr.jp"?true:B.cookie("up-to-date");if(!S){B.cookie(T,"[]",{expires:0,path:"/",domain:""});B.cookie(T,"[]",{expires:0,path:"/",domain:F});B.cookie("up-to-date","1",{expires:365*10,path:"/",domain:F})}if(!_.isEmpty(R)){R=JSON.parse(R)}else{R=[]}this.add=function(U){Q.remove(U,false);R.unshift(U);if(R.length>24){R=R.slice(0,24)}B.cookie(T,JSON.stringify(R),{expires:90,path:"/",domain:F});if(U.screen){B.cookie("size",U.screen,{expires:90,path:"/",domain:F})}};this.remove=function(W,V){for(var U in R){if(W.phone&&W.phone==R[U].phone||!W.phone&&!R[U].phone&&W.platform&&W.platform==R[U].platform||!W.phone&&!R[U].phone&&W.screen&&W.screen===R[U].screen){R.splice(U,1)}}if(V!==false){var X=R?JSON.stringify(R):"";B.cookie(T,X,{expires:90,path:"/",domain:F})}};this.getAll=function(){return _.filter(R,function(V,U){if(U===0){return true}if(b===u&&!V.phone&&!V.platform){return false}if(b===I&&!V.phone&&!V.screen){return false}return true})};this.getCurrent=function(){var U=R[0]?R[0]:null;return U}};var L=B("#phone-panel"),m=new i(),c=L.find(".input-block.phone .input"),h=c.find('input[name="phone"]'),n=L.find(".input-block.platform .input"),K=n.find('input[name="platform"]'),N=L.find(".input-block.screen .input"),l=N.find('input[name="screen"]'),w=[];var p=function(Q){B.ajax({type:"POST",url:"/xrequest/phonePanel/getItemData/",data:Q,success:function(R){H.setNewPanel(R)},dataType:"json"})};var D=B("#phone-panel-block");var z=function(R){R=B.extend({history:[]},R);if(m.getCurrent()){R.history=R.history.slice(1)}var Q=R.history.length>0&&R.history.length>2?" row3":(" row"+R.history.length);B.ajax({type:"POST",url:"/xrequest/phonePanel/getHistoryData/",data:{history:JSON.stringify(R.history)},success:function(T){var W=_.template(B("#scroll-list-tpl").html())({scrollerClass:"scroller-tiles",listId:"phone-input-list",listClass:"tiles-list"+Q,listType:"history-list",list:T});B("#phone-input-list").remove();c.append(W);var S=B("#phone-input-list"),V=S.find("li"),U=S.find(".scroller");U.customScroll();V.on("mousedown",function(){var X=B(this),Z=X.data("type"),Y={};Y[Z]=X.data("id");var aa=_.find(m.getAll(),function(ab){if(Z=="platform"&&!ab.phone&&ab.platform&&Y[Z]==ab.platform||Z=="phone"&&ab.phone&&Y[Z]==ab.phone||Z=="screen"&&!ab.phone&&ab.screen&&Y[Z]==ab.screen){return true}});p(aa)});V.find(".remove-item").on("mousedown",function(Z){Z.stopPropagation();var X=B(this).closest("li"),Y=X.data("type"),ab=X.data("id"),aa={};aa[Y]=ab;X.remove();m.remove(aa);V=S.find("li");Q=V.length>0&&V.length>2?" row3":(" row"+V.length);if(V.length===0){j()}else{U.find("ul").removeClass("row0 row1 row2 row3").addClass(Q);U.customScroll("update")}})},dataType:"json"})};var M=function(X){X=B.extend({phoneList:[]},X);var W=X.phoneList,Y=W.length>0&&W.length>2?" row3":(" row"+W.length),T=Y===" row3"?true:false;var W=_.template(B("#scroll-list-tpl").html())({scrollerClass:"scroller-tiles",listId:"phone-input-list",listClass:"tiles-list"+Y,listType:"phone-list",list:X.phoneList});c.append(W);var V=B("#phone-input-list"),U=V.find("li"),R=V.find(".scroller"),S=R.closest(".scroller-wrap"),Q=R.find("ul");R.customScroll();V.on("mousedown","li",function(){var Z=B(this).data("id");p({phone:Z})});if(U.length==X.numRows){Q.addClass("full");T=false}R.on("scroll",function(){if(T){if(Q.height()-R.scrollTop()-S.height()<50){T=false;B.ajax({type:"POST",url:"/xrequest/phonePanel/searchPhone/",data:{search_word:B.trim(h.val()),offset:U.length},success:function(Z){var aa="";for(var ab in Z.data){aa+='<li tabindex="0" data-id="'+Z.data[ab]["id"]+'"><div class="list-image"><img src="'+Z.data[ab]["imgUrl"]+'"/></div><div class="phone-title">'+Z.data[ab]["brand_phone"]+" "+Z.data[ab]["model_phone"]+"</div></li>"}Q.find(".phone-list-bottom").before(aa);R.customScroll("update");U=V.find("li");if(U.length==X.numRows){Q.addClass("full")}else{T=true}},dataType:"json"})}}})};var P=function(S){S=B.extend({brandList:[{name:"Apple"},{name:"HTC"},{name:"Samsung"},{name:"LG"},{name:"Fly"},{name:"Motorolla"},{name:"Sony"},{name:"Nokia"}]},S);var Q=_.template(B("#scroll-list-tpl").html())({scrollerClass:"scroller-list",listId:"phone-input-list",listClass:"table-list",listType:"brand-list",list:S.brandList});c.append(Q);var T=B("#phone-input-list"),R=T.find("li");T.find(".scroller").customScroll();R.on("mousedown",function(){var U=B(this).text();h.val(U);c.find(".clear-input").show();j({searchValue:B.trim(U)})})};var f=function(){var Q=[{name:"Android"},{name:"iOS"},{name:"Symbian"}];var T=_.template(B("#scroll-list-tpl").html())({scrollerClass:"scroller-list",listId:"platform-input-list",listClass:"table-list",listType:"default-platform-list",list:Q});n.append(T);var S=B("#platform-input-list"),R=S.find("li");S.find(".scroller").customScroll();R.on("mousedown",function(V){var U=B(this).text();K.val(U).trigger("input");k({searchValue:B.trim(U)})})};var s=function(R){R=B.extend({platformList:[]},R);var T=_.template(B("#scroll-list-tpl").html())({scrollerClass:"scroller-list",listId:"platform-input-list",listClass:"table-list",listType:"platform-list",list:R.platformList,defaultPlatform:L.find(".platform-tip-link").data("defaultPlatform")});n.append(T);var S=B("#platform-input-list"),Q=S.find("li");Q.on("mousedown",function(V){V.stopPropagation();var U={platform:B(this).data("id")};if(L.hasClass("no-platform")){U.phone=B("#phone-name").attr("data-phone-id")}p(U)});S.find(".scroller").customScroll()};var o=function(){var R=B("#platform-warning-widget").find(".input"),T=R.find("input"),Q=R.find(".scroller"),S=R.find("li");B("#platform-warning-widget").find(".scroller").customScroll({onSelect:function(V){V.stopPropagation();var U={platform:B(this).data("id")};if(L.hasClass("no-platform")){U.phone=B("#phone-name").attr("data-phone-id")}p(U)},onInput:function(){var V=R.find(".nothing-found"),U=B.trim(T.val());U=U.replace(/(\d)([^\d\s])/,"$1 $2").replace(/([^\d\s])(\d)/,"$1 $2").split(/\s+/);S.each(function(Z,aa){var W=B(aa),Y=false;for(var X in U){if(!new RegExp("\\b"+U[X],"i").test(W.text())){Y=true}}W.toggleClass("hidden",Y)});V.toggleClass("hidden",S.not(".hidden").length>0);Q.customScroll("update")},onClear:function(){S.removeClass("hidden");Q.customScroll("update");R.find(".nothing-found").addClass("hidden")}})};var C=function(){l.one("focus",function(){B.ajax({type:"POST",url:"/xrequest/phonePanel/getScreensizeList/",success:function(Q){var S=_.template(B("#scroll-list-tpl").html())({scrollerClass:"scroller-list",listId:"screensize-input-list",listClass:"table-list",listType:"screensize-list",list:Q.data});N.append(S);var U=N.find(".scroller"),R=U.find("li"),T={onSelect:function(){p({screen:B.trim(B(this).text())})},onInput:function(){var V=B.trim(l.val()),W=N.find(".nothing-found");if(V.length>0){R.removeClass("hidden");R.each(function(Z,aa){var X=B(aa),Y=V;X.toggleClass("hidden",!new RegExp("(^"+Y+")|(x"+Y+")","i").test(B.trim(X.text())))})}else{R.removeClass("hidden").not(".default").addClass("hidden")}W.toggleClass("hidden",R.not(".hidden").length>0);U.customScroll("update")},onClear:function(){R.removeClass("hidden").not(".default").addClass("hidden");U.customScroll("update");N.find(".nothing-found").addClass("hidden")}};U.customScroll(T);l.focus()},dataType:"json"})})};var j=function(Q){Q=B.extend({phoneList:null,numRows:0,searchValue:null,focus:true},Q);if(Q.searchValue){B.ajax({type:"POST",url:"/xrequest/phonePanel/searchPhone/",data:{search_word:Q.searchValue},success:function(S){j({phoneList:S.data,numRows:S.total})},dataType:"json"});return}B("#phone-input-list").remove();var R=m.getAll();if(Q.phoneList){new M({phoneList:Q.phoneList,numRows:Q.numRows})}else{if(R.length>1){new z({history:R})}else{new P()}}if(Q.focus){setTimeout(function(){h.focus()},0)}};var k=function(R){R=B.extend({searchValue:null,focus:true},R);var Q=B("#phone-panel").hasClass("no-platform")?g():{};B("#platform-input-list").remove();if(_.isEmpty(w)){B.ajax({type:"POST",url:"/xrequest/phonePanel/getPlatformList/",success:function(S){w=S.data;if(!_.isEmpty(w)){K.trigger("platformListLoaded")}},dataType:"json"});K.on("platformListLoaded",function(){k(R)});return}if(R.searchValue){R.searchValue+=Q.platform?(" "+Q.platform):"";new s({platformList:J(w,R.searchValue,Q.sort)})}else{if(Q.platform){new s({platformList:J(w,Q.platform,Q.sort)})}else{new f()}}if(R.focus){setTimeout(function(){K.focus()},0)}};var g=function(){var Q=L.find("#default-platform"),R=Q.data("defaultPlatform"),S=Q.data("platformSort");if(R==="android"){return{platform:"Android",sort:S}}if(R==="iphone"){return{platform:"iOS",sort:S}}return{}};var J=function(S,R,Q){var R=R.replace(/(\d)([^\d\s])/,"$1 $2").replace(/([^\d\s])(\d)/,"$1 $2").split(/\s+/),Q=parseInt(Q);return _.filter(S,function(U){var V=parseInt(U.sort);if(V<Q){return false}for(var T in R){if(!new RegExp("\\b"+R[T],"i").test(U.name)){return false}}return true})};var d=function(){var V={},X={};this.getNewPanel=function(){S();L.attr("class","phone-panel none-selected edited");h.val("");K.val("");l.val("");c.find(".clear-input").hide();n.find(".clear-input").hide();N.find(".clear-input").hide();N.find(".scroller").customScroll("update");j();k({focus:false})};this.setNewPanel=function(Z,ac){var ab={},Y="phone-panel";switch(Z.type){case"phone":Y+=" phone-selected";ab={phone:Z.id};if(Z.platformId){ab.platform=Z.platformId}if(Z.screenSize){ab.screen=Z.screenSize}if(Z.platformType=="os"&&!Z.platformId){Y+=" no-platform"+(ac?" cancelable":"")}break;case"platform":Y+=" platform-selected";ab={platform:Z.id};if(Z.screen){ab.screen=Z.screen}break;case"screen":Y+=" screensize-selected";ab={screen:Z.screenSize};break;default:break}X=m.getCurrent();m.add(ab);Z.platformFamily=Z.platformClass;if(Z.platformClass==="sis"){var aa="";if(r==="java"){aa=Z.links.java?Z.links.java:Z.links.sis}else{aa=Z.links.sis?Z.links.sis:Z.links.java}Z.gamesUrl=aa?aa.url:""}else{if(Z.links[Z.platformClass]){Z.gamesUrl=Z.links[Z.platformClass].url}else{Z.gamesUrl=Z.links.java?Z.links.java.url:""}}y(Z);Z.phonePanelClass=Y;Z.platformClass+=" platform sprite i-64";Z.links=_.template(B("#phone-panel-links-tpl").html())({links:Z.links});if(Z.type==="phone"){Z.phoneId=Z.id}U(Z);k({focus:false});N.find(".scroller").customScroll("update")};this.setOldPanel=function(){h.val("");K.val("");c.find(".clear-input").hide();n.find(".clear-input").hide();if(!_.isEmpty(V)){var Y={phoneInput:false,platformInput:false};U(V);if(X){Y.platformInput=true}else{Y.phoneInput=true}j({focus:Y.phoneInput});k({focus:Y.platformInput});N.find(".scroller").customScroll("update")}};var S=function(){V={phonePanelClass:B("#phone-panel").attr("class"),platformClass:B("#platform-image").attr("class"),url:B("#phone-link").attr("href"),imageUrl:B("#phone-image").attr("src"),phoneTitle:B("#phone-name").text(),phoneId:B("#phone-name").data("phoneId"),screenSize:B("#screensize").text(),platformTitle:B("#platform-name").text(),brandListLink:B("#brand-list-link").attr("href"),brandListText:B("#brand-list-link").text(),platformListLink:B("#platform-list-link").attr("href"),defaultPlatform:B("#default-platform").data("defaultPlatform"),platformSort:B("#default-platform").data("platformSort"),links:B("#phone-panel-links").html()}};var U=function(Y){B("#phone-panel").attr("class",Y.phonePanelClass);B("#platform-image").attr("class",Y.platformClass);B("#phone-link").attr("href",Y.url);B("#phone-image").attr("src",Y.imageUrl);B("#phone-name").text(Y.phoneTitle);B("#phone-name").attr("data-phone-id",Y.phoneId);B("#platform-name").text(Y.platformTitle);B("#screensize").text(Y.screenSize);B("#brand-list-link").attr("href",Y.brandListLink);B("#brand-list-link").text(Y.brandListText);B("#platform-list-link").attr("href",Y.platformListLink);B("#default-platform").data("defaultPlatform",Y.defaultPlatform);B("#default-platform").data("platformSort",Y.platformSort);B("#phone-panel-links").empty().html(Y.links)};L.on("mousedown",".cancel",function(Y){Y.stopPropagation();if(L.hasClass("no-platform")){m.remove(m.getCurrent())}H.setOldPanel()});L.on("click",".edit",function(){H.getNewPanel()});L.on("click",".plus",function(){h.focus()});L.on("click",function(){typeof ga!=="undefined"&&ga("send","event","panel","click")});B("#platform-warning-widget, #download-links-widget, .theme-content, .foto-editor").on("click",".change-phone",function(){var ad=L[0].getBoundingClientRect(),ab=ad.bottom-L.height(),aa=B(window).height()-ad.bottom-250,Y=v.scrollTop();if(aa<0){Y=v.scrollTop()-aa}if(ab<0){Y=v.scrollTop()+ab}var Z=300,ac=Z*(1-Z/(Math.abs(ab)+Z));B("html, body").animate({scrollTop:Y},ac,function(){if(L.hasClass("none-selected")){h.focus()}else{H.getNewPanel()}})});c.find(".clear-input").on("mousedown",j);n.find(".clear-input").on("mousedown",k);L.find('input[name="phone"]').on("input paste",_.debounce(function(){var Y=B(this).val();j({searchValue:B.trim(Y)})},300));L.find('input[name="platform"]').on("input paste",_.debounce(function(){var Y=B(this).val();k({searchValue:B.trim(Y)})},300));var T=B("#phone-panel, #platform-warning-widget"),W=T.find('input[type="text"]'),R=T.find(".platform-info-link"),Q=T.find(".platform-tooltip");W.on("focus mousedown",function(){B(".input").not(B(this).closest(".input")).removeClass("open")});R.on("click",function(Y){Y.stopPropagation();B(this).closest(".info-block").find(".platform-tooltip").toggle()});v.on("click",function(){Q.hide()});j({focus:false});k({focus:false});new C();if(L.hasClass("no-platform")){new o()}S();D.css("height",L.outerHeight()+"px");L.find('input[type="text"]').on("focus",function(){if(!B.contains(document.documentElement,G[0])&&L.closest("#popup").length===0){A.prepend(G);L.css({position:"relative","z-index":9})}});v.on("mousedown",function(){G.detach();L.css({"z-index":"auto"})})};var H=new d()})(window.jQuery);(function(b){var c=b(document),d="",a="android";c.on("mousedown",".platform-tip-link",function(){a=b(this).data("defaultPlatform");if(d.length===0){b.ajax({url:"/xrequest/getPlatformTip/",success:function(e){d=e;c.trigger("platform-tip")},dataType:"text"})}else{c.trigger("platform-tip")}});c.on("platform-tip",function(){b.jPopup({content:d,onRender:function(){b(".platform-tooltip").hide();var f=b("#popup"),e=f.find(".tip-tab");e.on("click",function(){var h=b(this),g=h.data("platform");b(".tip-tab").not(h).removeClass("selected");h.addClass("selected");b(".tip-content").each(function(){var i=b(this);i.toggleClass("open",i.hasClass(g))})});e.filter("."+a).trigger("click")}})})})(window.jQuery);!function(b){"function"==typeof define&&define.amd?define(["jquery"],b):"object"==typeof exports?module.exports=b:b(jQuery)}(function(v){function u(z){var y=z||window.event,x=n.call(arguments,1),w=0,k=0,i=0,f=0,e=0,d=0;if(z=v.event.fix(y),z.type="mousewheel","detail" in y&&(i=-1*y.detail),"wheelDelta" in y&&(i=y.wheelDelta),"wheelDeltaY" in y&&(i=y.wheelDeltaY),"wheelDeltaX" in y&&(k=-1*y.wheelDeltaX),"axis" in y&&y.axis===y.HORIZONTAL_AXIS&&(k=-1*i,i=0),w=0===i?k:i,"deltaY" in y&&(i=-1*y.deltaY,w=i),"deltaX" in y&&(k=y.deltaX,0===i&&(w=-1*k)),0!==i||0!==k){if(1===y.deltaMode){var c=v.data(this,"mousewheel-line-height");w*=c,i*=c,k*=c}else{if(2===y.deltaMode){var a=v.data(this,"mousewheel-page-height");w*=a,i*=a,k*=a}}if(f=Math.max(Math.abs(i),Math.abs(k)),(!q||q>f)&&(q=f,s(y,f)&&(q/=40)),s(y,f)&&(w/=40,k/=40,i/=40),w=Math[w>=1?"floor":"ceil"](w/q),k=Math[k>=1?"floor":"ceil"](k/q),i=Math[i>=1?"floor":"ceil"](i/q),l.settings.normalizeOffset&&this.getBoundingClientRect){var A=this.getBoundingClientRect();e=z.clientX-A.left,d=z.clientY-A.top}return z.deltaX=k,z.deltaY=i,z.deltaFactor=q,z.offsetX=e,z.offsetY=d,z.deltaMode=0,x.unshift(z,w,k,i),r&&clearTimeout(r),r=setTimeout(t,200),(v.event.dispatch||v.event.handle).apply(this,x)}}function t(){q=null}function s(d,c){return l.settings.adjustOldDeltas&&"mousewheel"===d.type&&c%120===0}var r,q,p=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],o="onwheel" in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],n=Array.prototype.slice;if(v.event.fixHooks){for(var m=p.length;m;){v.event.fixHooks[p[--m]]=v.event.mouseHooks}}var l=v.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener){for(var a=o.length;a;){this.addEventListener(o[--a],u,!1)}}else{this.onmousewheel=u}v.data(this,"mousewheel-line-height",l.getLineHeight(this)),v.data(this,"mousewheel-page-height",l.getPageHeight(this))},teardown:function(){if(this.removeEventListener){for(var a=o.length;a;){this.removeEventListener(o[--a],u,!1)}}else{this.onmousewheel=null}v.removeData(this,"mousewheel-line-height"),v.removeData(this,"mousewheel-page-height")},getLineHeight:function(a){var f=v(a),e=f["offsetParent" in v.fn?"offsetParent":"parent"]();return e.length||(e=v("body")),parseInt(e.css("fontSize"),10)||parseInt(f.css("fontSize"),10)||16},getPageHeight:function(a){return v(a).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};v.fn.extend({mousewheel:function(b){return b?this.bind("mousewheel",b):this.trigger("mousewheel")},unmousewheel:function(b){return this.unbind("mousewheel",b)}})});(function(g){var f=function(p,n,o,q){if(p+q<o){return o-p}else{if(n<p+q){return n-p}}return q};var l=function(s,z,q,w,v){var u=s.cur,x=s.limit.max,r=s.limit.min,y=Math.round;q=typeof q=="undefined"?z.dZoom:q;w=typeof w=="undefined"?s.wnd.width/2-u.left:w;v=typeof v=="undefined"?s.wnd.height/2-u.top:v;var p=w/u.width,o=v/u.height,n=f(u.width,x.width,r.width,u.width*q),t=f(u.height,x.height,r.height,u.height*q);if(n==0&&t==0){return}u.width=y(u.width+n);u.height=y(u.height+t);u.left-=y(p*n);u.top-=y(o*t)};var b=function(p,o,E,s,B){var t=parseInt(p.css("border-left-width"),10),r=parseInt(p.css("border-top-width"),10),y=s.wnd={width:p.innerWidth(),height:p.innerHeight(),left:p.offset().left+t,top:p.offset().top+r};var A=Math.ceil,D=Math.round,x=Math.floor,v=s.cur={},q=o.width(),C=o.height();var n=1/Math.min(q/y.width,C/y.height);var u=E.xZoom=Math.max(E.maxScale,E.maxScale/n);v.width=A(q*n);v.height=A(C*n);v.top=D(0.5*(y.height-v.height));v.left=D(0.5*(y.width-v.width));s.limit={min:{width:A(q*n),height:A(C*n)},max:{width:x(q*n*u),height:x(C*n*u)}};s.orig={width:q,height:C};if(B.y>-1){v.top=D(B.y/100*(y.height-v.height))}if(B.x>-1){v.left=D(B.x/100*(y.width-v.width))}};var k=function(p,o,n){if(p<o){return o}if(n<p){return n}return p};var i=function(p){var q=p.cur,o=p.limit.max,n=p.limit.min;q.width=k(q.width,n.width,o.width);q.height=k(q.height,n.height,o.height);q.top=k(q.top,p.wnd.height-q.height,0);q.left=k(q.left,p.wnd.width-q.width,0)};var j=function(o,n){return 1-Math.log(o)/Math.log(n)};var e=function(o,n){return Math.pow(n,1-(o))};var a=function(p,q,n){var r=q.cur.width/q.limit.min.width;var o=e(p/n.sliderDistance,n.xZoom);return(o/r)-1};var h={overflow:"hidden",position:"relative","background-size":"cover"},d={cursor:"move",position:"absolute",top:0,left:0,width:"auto",height:"auto",visibility:"hidden"},c=g(window);var m=function(p){var s=p[0].zumchikParams,r=Math.abs(s.cur.left),q=Math.abs(s.cur.top),o=r+s.wnd.width,n=q+s.wnd.height;return{scale:s.cur.width/s.orig.width,leftTop:{left:r,top:q},rightBottom:{right:o,bottom:n}}};g.fn.zumchik=function(n){var o={x:void 0,y:void 0};if(n=="params"){return m(g(this).first())}else{if(g.isPlainObject(n)){o={x:k(n.x,0,100),y:k(n.y,0,100)}}}return this.each(function(){var q=g(this),p=q.find("img"),w=g("<div class='zumchik-slider'></div>"),v=g("<div class='pimpochka'></div>"),u={},x={},r={},s;this.zumchikParams=r;q.append(w.append(v));var t={};t.img={startDrag:function(y){p.addClass("dragging");c.on("mousemove.zumchik",function(z){var A=p.position();r.cur.top=A.top+z.pageY-u.y;r.cur.left=A.left+z.pageX-u.x;u={x:z.pageX,y:z.pageY};t.img.update()});c.one("mouseup.zumchik",function(){p.removeClass("dragging");c.off("mousemove.zumchik")});u={x:y.pageX,y:y.pageY};y.preventDefault()},update:function(){i(r);p.css(r.cur)},wheel:function(B,C){var A=C>0?x.dZoom:-x.dZoom,z=B.pageX-r.wnd.left-r.cur.left,y=B.pageY-r.wnd.top-r.cur.top;l(r,x,A,z,y);t.img.update();t.pimpochka.update();B.preventDefault()},load:function(){b(q,p,x,r,o);p.css(g.extend({},r.cur,{visibility:"visible"}));x.sliderDistance=w.height()-v.outerHeight();t.pimpochka.update()}};t.pimpochka={startDrag:function(z){s=parseInt(g(this).css("border-top-width"),10)+v.width()/2;var y=k(z.pageY-w.offset().top-s,0,x.sliderDistance);l(r,x,a(y,r,x));t.img.update();t.pimpochka.update();c.on("mousemove.zumchik",function(B){var A=k(B.pageY-w.offset().top-s,0,x.sliderDistance);t.pimpochka.update();l(r,x,a(A,r,x));t.img.update()});c.one("mouseup.zumchik",function(){v.removeClass("dragging");c.off("mousemove.zumchik")});z.preventDefault()},update:function(){var z=r.cur.width/r.limit.min.width;var y=Math.round(x.sliderDistance*j(z,x.xZoom));v.css({top:y})}};x={dZoom:0.15,maxScale:2,xZoom:2,sliderDistance:0};q.css(h);q.css({"background-image":"url("+p.attr("src")+")","background-position":(o.x?o.x:50)+"% "+(o.y?o.y:50)+"%"});p.css(d);p[0].complete?t.img.load():p.one("load.zumchik",t.img.load);p.on("mousedown.zumchik",t.img.startDrag);p.on("mousewheel.zumchik",t.img.wheel);w.on("mousedown.zumchik",t.pimpochka.startDrag)})}}(window.jQuery||window.$));(function(g,h,c){var f=function(j){console.log(j)};var b=g(h),i=h.document,e=g(i);var a=(function(){var l,j=3,m=i.createElement("div"),k=m.getElementsByTagName("i");while(m.innerHTML="<!--[if gt IE "+(++j)+"]><i></i><![endif]-->",k[0]){}return j>4?j:l})();var d=function(){var l=h.pageXOffset!==c?h.pageXOffset:(i.compatMode=="CSS1Compat"?h.document.documentElement.scrollLeft:h.document.body.scrollLeft),m=h.pageYOffset!==c?h.pageYOffset:(i.compatMode=="CSS1Compat"?h.document.documentElement.scrollTop:h.document.body.scrollTop);if(typeof d.x=="undefined"){d.x=l;d.y=m}if(typeof d.distanceX=="undefined"){d.distanceX=l;d.distanceY=m}else{d.distanceX=l-d.x;d.distanceY=m-d.y}var k=d.x-l,j=d.y-m;d.direction=k<0?"right":k>0?"left":j<=0?"down":j>0?"up":"first";d.x=l;d.y=m};b.on("scroll",d);g.fn.style=function(k){if(!k){return null}var n=g(this),m;var l=n.clone().css("display","none");l.find("input:radio").attr("name","copy-"+Math.floor((Math.random()*100)+1));n.after(l);var j=function(p,o){var q;if(p.currentStyle){q=p.currentStyle[o.replace(/-\w/g,function(r){return r.toUpperCase().replace("-","")})]}else{if(h.getComputedStyle){q=i.defaultView.getComputedStyle(p,null).getPropertyValue(o)}}q=(/margin/g.test(o))?((parseInt(q)===n[0].offsetLeft)?q:"auto"):q;return q};if(typeof k=="string"){m=j(l[0],k)}else{m={};g.each(k,function(o,p){m[p]=j(l[0],p)})}l.remove();return m||null};g.fn.extend({hcSticky:function(j){if(this.length==0){return this}this.pluginOptions("hcSticky",{top:0,bottom:0,bottomEnd:0,innerTop:0,innerSticker:null,className:"sticky",wrapperClassName:"wrapper-sticky",stickTo:null,responsive:true,followScroll:true,offResolutions:null,onStart:g.noop,onStop:g.noop,on:true,fn:null},j||{},{reinit:function(){g(this).hcSticky()},stop:function(){g(this).pluginOptions("hcSticky",{on:false}).each(function(){var n=g(this),k=n.pluginOptions("hcSticky"),l=n.parent("."+k.wrapperClassName);var m=n.offset().top-l.offset().top;n.css({position:"absolute",top:m,bottom:"auto",left:"auto",right:"auto"}).removeClass(k.className)})},off:function(){g(this).pluginOptions("hcSticky",{on:false}).each(function(){var m=g(this),k=m.pluginOptions("hcSticky"),l=m.parent("."+k.wrapperClassName);m.css({position:"relative",top:"auto",bottom:"auto",left:"auto",right:"auto"}).removeClass(k.className);l.css("height","auto")})},on:function(){g(this).each(function(){g(this).pluginOptions("hcSticky",{on:true,remember:{offsetTop:b.scrollTop()}}).hcSticky()})},destroy:function(){var m=g(this),k=m.pluginOptions("hcSticky"),l=m.parent("."+k.wrapperClassName);m.removeData("hcStickyInit").css({position:l.css("position"),top:l.css("top"),bottom:l.css("bottom"),left:l.css("left"),right:l.css("right")}).removeClass(k.className);b.off("resize",k.fn.resize).off("scroll",k.fn.scroll);m.unwrap()}});if(j&&typeof j.on!="undefined"){if(j.on){this.hcSticky("on")}else{this.hcSticky("off")}}if(typeof j=="string"){return this}return this.each(function(){var q=g(this),w=q.pluginOptions("hcSticky");var m=(function(){var x=q.parent("."+w.wrapperClassName);if(x.length>0){x.css({height:q.outerHeight(true),width:(function(){var y=x.style("width");if(y.indexOf("%")>=0||y=="auto"){if(q.css("box-sizing")=="border-box"||q.css("-moz-box-sizing")=="border-box"){q.css("width",x.width())}else{q.css("width",x.width()-parseInt(q.css("padding-left")-parseInt(q.css("padding-right"))))}return y}else{return q.outerWidth(true)}})()});return x}else{return false}})()||(function(){var y=q.style(["width","margin-left","left","right","top","bottom","float","display"]);var z=q.css("display");var x=g("<div>",{"class":w.wrapperClassName}).css({display:z,height:q.outerHeight(true),width:(function(){if(y.width.indexOf("%")>=0||(y.width=="auto"&&z!="inline-block"&&z!="inline")){q.css("width",parseFloat(q.css("width")));return y.width}else{if(y.width=="auto"&&(z=="inline-block"||z=="inline")){return q.width()}else{return(y["margin-left"]=="auto")?q.outerWidth():q.outerWidth(true)}}})(),margin:(y["margin-left"])?"auto":null,position:(function(){var A=q.css("position");return A=="static"?"relative":A})(),"float":y["float"]||null,left:y.left,right:y.right,top:y.top,bottom:y.bottom,"vertical-align":"top"});q.wrap(x);if(a===7){if(g("head").find("style#hcsticky-iefix").length===0){g('<style id="hcsticky-iefix">.'+w.wrapperClassName+" {zoom: 1;}</style>").appendTo("head")}}return q.parent()})();if(q.data("hcStickyInit")){return}q.data("hcStickyInit",true);var v=w.stickTo&&(w.stickTo=="document"||(w.stickTo.nodeType&&w.stickTo.nodeType==9)||(typeof w.stickTo=="object"&&w.stickTo instanceof (typeof HTMLDocument!="undefined"?HTMLDocument:Document)))?true:false;var u=w.stickTo?v?e:typeof w.stickTo=="string"?g(w.stickTo):w.stickTo:m.parent();q.css({top:"auto",bottom:"auto",left:"auto",right:"auto"});b.load(function(){if(q.outerHeight(true)>u.height()){m.css("height",q.outerHeight(true));q.hcSticky("reinit")}});var t=function(x){if(q.hasClass(w.className)){return}x=x||{};q.css({position:"fixed",top:x.top||0,left:x.left||m.offset().left}).addClass(w.className);w.onStart.apply(q[0]);m.addClass("sticky-active")},r=function(x){x=x||{};x.position=x.position||"absolute";x.top=x.top||0;x.left=x.left||0;if(q.css("position")!="fixed"&&parseInt(q.css("top"))==x.top){return}q.css({position:x.position,top:x.top,left:x.left}).removeClass(w.className);w.onStop.apply(q[0]);m.removeClass("sticky-active")};var p=function(G){if(!w.on||!q.is(":visible")){return}if(q.outerHeight(true)>=u.height()){r();return}var x=(w.innerSticker)?g(w.innerSticker).position().top:((w.innerTop)?w.innerTop:0),A=m.offset().top,B=u.height()-w.bottomEnd+(v?0:A),D=m.offset().top-w.top+x,F=q.outerHeight(true)+w.bottom,H=b.height(),E=b.scrollTop(),z=q.offset().top,y=z-E,I;if(typeof w.remember!="undefined"&&w.remember){var C=z-w.top-x;if(F-x>H&&w.followScroll){if(C<E&&E+H<=C+q.height()){w.remember=false}}else{if(w.remember.offsetTop>C){if(E<=C){t({top:w.top-x});w.remember=false}}else{if(E>=C){t({top:w.top-x});w.remember=false}}}return}if(E>D){if(B+w.bottom-(w.followScroll&&H<F?0:w.top)<=E+F-x-((F-x>H-(D-x)&&w.followScroll)?(((I=F-H-x)>0)?I:0):0)){r({top:B-F+w.bottom-A})}else{if(F-x>H&&w.followScroll){if(y+F<=H){if(d.direction=="down"){t({top:H-F})}else{if(y<0&&q.css("position")=="fixed"){r({top:z-(D+w.top-x)-d.distanceY})}}}else{if(d.direction=="up"&&z>=E+w.top-x){t({top:w.top-x})}else{if(d.direction=="down"&&z+F>H&&q.css("position")=="fixed"){r({top:z-(D+w.top-x)-d.distanceY})}}}}else{t({top:w.top-x})}}}else{r()}};var o=false,s=false;var k=function(){n();l();if(!w.on){return}var y=function(){if(q.css("position")=="fixed"){q.css("left",m.offset().left)}else{q.css("left",0)}};if(w.responsive){if(!s){s=q.clone().attr("style","").css({visibility:"hidden",height:0,overflow:"hidden",paddingTop:0,paddingBottom:0,marginTop:0,marginBottom:0});m.after(s)}var x=m.style("width");var A=s.style("width");if(A=="auto"&&x!="auto"){A=parseInt(q.css("width"))}if(A!=x){m.width(A)}if(o){clearTimeout(o)}o=setTimeout(function(){o=false;s.remove();s=false},250)}y();if(q.outerWidth(true)!=m.width()){var z=(q.css("box-sizing")=="border-box"||q.css("-moz-box-sizing")=="border-box")?m.width():m.width()-parseInt(q.css("padding-left"))-parseInt(q.css("padding-right"));z=z-parseInt(q.css("margin-left"))-parseInt(q.css("margin-right"));q.css("width",z)}};q.pluginOptions("hcSticky",{fn:{scroll:p,resize:k}});var l=function(){if(w.offResolutions){if(!g.isArray(w.offResolutions)){w.offResolutions=[w.offResolutions]}var x=true;g.each(w.offResolutions,function(y,z){if(z<0){if(b.width()<z*-1){x=false;q.hcSticky("off")}}else{if(b.width()>z){x=false;q.hcSticky("off")}}});if(x&&!w.on){q.hcSticky("on")}}};l();b.on("resize",k);var n=function(){var x=false;if(g._data(h,"events").scroll!=c){g.each(g._data(h,"events").scroll,function(y,z){if(z.handler==w.fn.scroll){x=true}})}if(!x){w.fn.scroll(true);b.on("scroll",w.fn.scroll)}};n()})}})})(jQuery,this);(function(a,b){a.fn.extend({pluginOptions:function(e,d,f,c){if(!this.data(e)){this.data(e,{})}if(e&&typeof d=="undefined"){return this.data(e).options}f=f||(d||{});if(typeof f=="object"||f===b){return this.each(function(){var g=a(this);if(!g.data(e).options){g.data(e,{options:a.extend(d,f||{})});if(c){g.data(e).commands=c}}else{g.data(e,a.extend(g.data(e),{options:a.extend(g.data(e).options,f||{})}))}})}else{if(typeof f=="string"){return this.each(function(){a(this).data(e).commands[f].call(this)})}else{return this}}}})})(jQuery);(function(){var a=$("#announce-subscribe");if(a.length===0){return}var b=a.closest(".announce-subscribe").find('.email input[type="text"]'),c=function(){a.removeClass("loading");b.errorTooltip(b.data("invalid")).closest(".error-container").addClass("error");b.focus()};b.on("input paste",function(){$(this).errorTooltip("remove").closest(".error-container").removeClass("error")});b.on("keydown",function(d){if(d.keyCode===13){a.click()}});a.on("click",function(){var d=$.trim(b.val()),e={gameType:a.data("gameType"),gameId:a.data("gameId"),email:d};if(a.hasClass("loading")){return}a.addClass("loading");if(_.isEmpty(d)||!_.isString(d)||!d.match(/^\w+([.-]\w+)*@\w+([.-]?\w+)*(\.\w{2,4})+$/)||d.length>255){return c()}$.ajax({type:"POST",dataType:"text",url:"/xrequest/announceSubscribe",data:e,success:function(){$("#announce-subscribe-block").empty().append(_.template($("#announce-subscribe-ok-tpl").html())({email:d}))},error:function(){$.jNotify({msg:a.data("error")})},complete:function(){a.removeClass("loading")}})})})();(function(){var f=$(window),c=$("#extra-games-tiles");if(c.length===0){return}var b=c.find(".show-more-btn");if(c.find(".game-m.hidden").length===0){$("#show-more").remove();return}var e=false;var d=function(){if(e){return}b.off("click.recommended");f.off("scroll.recommended");$("#show-more").remove();e=true;var g=c.find(".game-m.hidden");g.each(function(j,k){var l=$(k),h=l.find("img");h.attr("src",h.data("src"));l.removeClass("hidden")})};var a=c.offset().top;f.on("scroll.recommended",function(){if(a<=f.height()+f.scrollTop()){d()}}).scroll();b.on("click.recommended",d)})();window.preloader=function(){$.jPopup({content:'<i class="preloader"></i>',verticalAlign:"middle",bgColorClass:"white",permanent:"true"});var b=$(".preloader"),a=1;setInterval(function(){a=a>7?0:a;b.css("background-position",-a*128+"px 0");a++},100)};(function(){var d=$(window),c=$("body"),a=c.data("cookieDomain");$("#mobile-version").on("click",function(f){f.preventDefault();$.cookie("m",1,{expires:1,path:"/",domain:a});if(c.data("currentSection")){window.location.reload()}else{window.location="http://"+window.location.hostname}});function b(e){if(!e.complete){return false}if(typeof e.naturalWidth!="undefined"&&e.naturalWidth==0){return false}return true}(function(){var e=$(".game-item");if(e.length===0){return}d.load(function(){e.find(".image img").each(function(){if(b(this)){$(this).css({width:"",height:""})}})})})();(function(){var e=$(".game");if(e.length===0){return}d.load(function(){e.find(".screenshots img").each(function(){if(b(this)){$(this).css({width:"",height:""})}})})})();d.load(function(){var e=$(".scroll-me");if(e.length===0){return}e.hScroller()});(function(){var f=$(".youtube-container");if(f.length===0){return}var g=f.closest(".video-wrap").first(),e=function(){var i=g.width(),h=d.height(),k=(16/9).toPrecision(3),j=0,l=0;if((i/h).toPrecision(3)>k){l=(h<200?200:h)+"px";j=(parseInt(l)*k)+"px"}else{j="100%";l="56.25%"}f.each(function(){$(this).css({width:j,"padding-bottom":l})})};d.on("resize",_.debounce(e,100)).resize()})();$("#searchForm a").click(function(){var e=$(".sprite",this);$('#searchForm [name="type"]').val(e.data("type"));$(".nav-top-search").find('[data-toggle="dropdown"] > .sprite').attr("class",e.attr("class"))});$(".img-hover").hover(function(){var e=$("img",this),f=$(this),g=f.closest(".container");if(f.height()<e.height()||f.width()<e.width()){f.addClass("overlay-image").css({position:"absolute",top:e.offset().top-1-g.offset().top,left:e.offset().left-1-g.offset().left,width:e.width(),height:e.height(),zIndex:900}).parent().find("a:not(.img-hover)").css({marginTop:f.outerHeight(true)})}},function(){$(this).removeClass("overlay-image").attr("style","").parent().find("a:not(.img-hover)").attr("style","")});$(".button-top").click(function(){$("html, body").animate({scrollTop:0},500)});(function(){var f=$(".rating-block");if(f.length===0){return}var e=f.find(".up, .down");e.on("click",function(h){h.stopPropagation();if(f.hasClass("voted-up")||f.hasClass("voted-down")){$.jNotify({msg:f.data("voteErr")});return}var j=$(this).attr("class"),g=f.data("vote-pass"),i=parseInt($("#vote-count").text().replace(/\s/g,""));if(!i){i=0}i=(++i).toString().replace(/\B(?=(\d{3})+(?!\d))/g," ");$("#vote-count").text(i);f.addClass("voted-"+j);if(j==="up"){f.addClass("with-btn")}$.ajax({type:"POST",dataType:"json",data:{vote:"vote-"+(j==="down"?"no":"yes"),hash:g}})})})();(function(){var e=$(".share-vk");if(e.length===0){return}e.on("click",function(){var f=$(this).data("gameTitle");window.open("http://vk.com/share.php?url="+encodeURIComponent(window.location.href)+"&description=!&title="+encodeURIComponent(f),"VK","location,width=600,height=300,top=0")})})();(function(){var e=$(".download-block .qr-code");if(e.length===0){return}e.click(function(){var f=$(this).closest(".qr-code-link").data("url");$.ajax({type:"POST",url:"/Xrequest/getQRHash",data:{data:f},success:function(){var h=_.template($("#qr-popup-tpl").html())({url:f});var g=$.jPopup({content:h})}});return false})})();(function(){var g=$(".input.sizes"),h=$(".input.colors"),f=g.find("input"),e=h.find("input");if(h.length===0&&g.length===0){return}var i=function(l){l.preventDefault();l.stopPropagation();var j=$(this).closest(".input"),k=j.hasClass("colors")?g:h;k.removeClass("open");j.toggleClass("open")};g.find(".scroller").customScroll({onSelect:function(j){j.stopPropagation();j.preventDefault()},onFocus:function(){f.blur()}});setTimeout(function(){h.find(".scroller").customScroll({onSelect:function(j){j.stopPropagation();j.preventDefault()},onFocus:function(){e.blur()}})},100);f.off("mousedown");g.on("mousedown","input, .color-label, .arrow-down-small",i);e.off("mousedown");h.on("mousedown","input, .color-label, .arrow-down-small",i)})();(function(){$("#brand-model-list").find("li").on("click",function(){var e=$(this).data("redirectHref");if(e){document.location.href=e}})})();(function(){var e=$("#w, #h");e.on("input paste",function(){var f=$(this);f.errorTooltip("remove");f.closest(".error-container").removeClass("error")});e.keydown(function(f){if($.inArray(f.keyCode,[46,8,9,27,13,110])!==-1||(f.keyCode==65&&f.ctrlKey===true)||(f.keyCode>=35&&f.keyCode<=39)){return}if((f.shiftKey||(f.keyCode<48||f.keyCode>57))&&(f.keyCode<96||f.keyCode>105)){f.preventDefault()}});$("#set-size").on("click",function(){var f=parseInt($("#w").val()),g=parseInt($("#h").val()),k=$(this).data("href");var i=true,j=false;if(isNaN(f)||f<1){i=false;$("#w").errorTooltip($("#w").data("invalid")).closest(".error-container").addClass("error");$("#w").focus();j=true}if(isNaN(g)||g<1){i=false;$("#h").errorTooltip($("#h").data("invalid")).closest(".error-container").addClass("error");if(!j){$("#h").focus()}}if(i){$.post("/screensize/",{w:f,h:g},function(){window.location=k.replace(/-x-/,f+"x"+g)})}return false})})();(function(){var e=$(".btn-wrong");if(e.length===0){return}e.on("mouseenter",function(){var g=$(this),f=g.data("error");g.errorTooltip(f);g.one("mouseleave",function(h){if($(h.relatedTarget).is(".error-tooltip, .error-tooltip-arrow-bg, .error-tooltip-arrow")){return}g.errorTooltip("remove")})})})();d.load(function(){var f=$(".preloader");if(f.length===0){return}var e=function(){var g=1;setInterval(function(){g=g>7?0:g;f.css("background-position",-g*128+"px 0");g++},100)};e()});(function(){var e=$(".section-menu");if(e.length===0){return}$(".section-menu").find("a.selected").parents(".section").addClass("open");$(".section-header").on("click",function(){$(this).closest(".section").toggleClass("open")})})();(function(){var e=$(".languages");e.find("a").on("click",function(){var g=$(this).data("lang");if($("html").attr("lang")==="en"){$.cookie("lang",g,{expires:365*10,path:"/",domain:a})}else{var f=$("<img>").attr("src","http://mob.org/setlang/?lang="+g).css("display","none");$("body").append(f)}});$(".selected-language").on("click",function(f){f.stopPropagation();$(this).closest("li").find(".languages").toggleClass("open")});$(document).on("click closeMenus",function(){e.removeClass("open")})})();$(function(){var e=$(".left-panel .left-column");e.find(".column-banner").css("height",e.height()-e.find(".column-content").height())});(function(){var e=null;var g=function(){var k=$(this),n="",m=k.offset(),p=$("<div></div>",{id:"image-overlay"}).css({"z-index":1001,position:"absolute",top:m.top+"px",left:m.left+"px",width:"114px",height:"114px","background-color":"#ffffff"});if(k.closest("a").length>0){n=k.closest("a").attr("href")}else{n=k.find("a").first().attr("href")}$("#page-header").prepend(p);var o=k.find("img"),h=o.clone(),l=o.width(),i=o.height(),j=$("<a></a>").attr("href",n);h.css("display","block");j.attr("id","overlay-image").css({"z-index":1001,position:"absolute",top:(m.top-Math.floor((i-112)/2))+"px",left:(m.left-Math.floor((l-112)/2))+"px",cursor:"pointer"}).append(h);p.after(j);j.on("click",f);j.on("mouseenter",function(){clearTimeout(e)})};var f=function(){$("#overlay-image").remove();$("#image-overlay").remove()};$(document).on("mouseenter",".pop-real-image",function(){f();g.apply(this);e=setTimeout(function(){f()},100)});$(document).on("mouseleave","#overlay-image",function(){f()});d.on("resize",function(){f()})})();d.load(function(){$("#banner-top-right").hcSticky({responsive:true,followScroll:false,bottomEnd:$("#phone-panel-block").outerHeight()-10,innerTop:25});$("#banner-left-common").hcSticky({responsive:true,followScroll:false,bottomEnd:$("#left-column-content").outerHeight()-10,innerTop:15})});$(function(){if($("#vk-group").length===0){return}var g=$("#vk-like"),h=c.data("currentSection")+"_liked",f=g.data("vkGroup");VK.Widgets.Group("vk-group",{mode:0,width:"220",height:"100",color1:"FFFFFF",color2:"2B587A",color3:"5B7FA6"},f);var e=$.jPopup({popupClass:"like-popup",verticalAdjust:false,verticalAlign:"middle"});g.find(".close").on("click",e.close);g.find(".do-not-show").on("click",function(){e.close();$.cookie(h,1,{expires:365*10,path:"/",domain:a})});e.setContent(g.css("display","block"));VK.Observer.subscribe("widgets.groups.joined",function(){var i=g.data("thanks");e.setContent('<div style="font-size: 24px; width: 400px; padding: 60px 40px; text-align: center; background-color: #ffffff;">'+i+"</div>");setTimeout(function(){e.close()},2000);$.cookie(h,1,{expires:365*10,path:"/",domain:a})})});(function(j,m,e){var l=j.getElementById("fb-root");if(!l){return}var i=c.data("currentSection")+"_liked";$(function(){facebookReady=function(){FB.Event.subscribe("xfbml.render",function(){var n=$.jPopup({popupClass:"like-popup",verticalAdjust:false,verticalAlign:"middle"});var o=$("#fb-like").css("display","block");o.find(".close").on("click",n.close);o.find(".do-not-show").on("click",function(){n.close();$.cookie(i,1,{expires:365*10,path:"/",domain:a})});n.setContent(o);FB.Event.subscribe("edge.create",function(){var p=o.data("thanks");n.setContent('<div style="font-size: 24px; width: 400px; padding: 60px 40px; text-align: center; background-color: #ffffff;">'+p+"</div>");setTimeout(function(){n.close()},2000);$.cookie(i,1,{expires:365*10,path:"/",domain:a})})})};if(window.FB){facebookReady()}else{window.fbAsyncInit=facebookReady}});var f,h=j.getElementsByTagName(m)[0],k=l.getAttribute("data-locale"),g=k?k:"en_US";if(j.getElementById(e)){return}f=j.createElement(m);f.id=e;f.src="//connect.facebook.net/"+g+"/sdk.js#xfbml=1&appId=396396360410649&version=v2.5";h.parentNode.insertBefore(f,h)})(document,"script","facebook-jssdk")})();(function(){var i=$("#searchForm"),e=i.closest(".nav-top-search"),h=i.find(".form-control"),b=$(),f=$("<div></div>",{id:"content-shadow"}),j=i.find(".input-group-btn"),g=j.find("li"),d=0;var a=15;j.on("mousedown",function(k){k.stopPropagation();e.removeClass("open");if(e.find(".track.playing").length>0){window.player.stopPlaying()}if(!$(this).hasClass("open")){if(!$.contains(document.documentElement,f[0])){$(".container").first().prepend(f)}}else{f.detach()}$(document).trigger("closeMenus")});g.on("mousedown",function(k){k.stopPropagation();$("#search-list").remove();h.trigger("input");setTimeout(function(){h.focus()},0)});h.on("focus mousedown",function(k){k.stopPropagation();$(".input").not(e).removeClass("open");if(!$.contains(document.documentElement,f[0])){$(".container").first().prepend(f)}e.addClass("open")});$(document).on("mousedown",function(){f.detach();j.removeClass("open");e.removeClass("open");if(e.find(".track.playing").length>0){window.player.stopPlaying()}});h.on("input",function(){var k=$(this).val();if(!k){$("#search-list").remove();e.removeClass("loading");return}e.addClass("loading")});h.on("keydown",function(k){if(k.keyCode==13){k.preventDefault()}});h.on("input",_.debounce(function(){var k=$(this).val(),m=i.find('input[name="type"]').val(),l="";switch(m){case"pic":l="picture-search-list";break;case"ringtone":l="ringtone-search-list";break;default:l="game-search-list";break}if(!k){return}$.ajax({type:"POST",url:"/xrequest/search/",data:{razdel:m,search_word:k,limit:a,offset:0},success:function(n){var q="";$("#search-list").remove();if(l==="ringtone-search-list"){q=_.template($("#ringtone-scroll-list-tpl").html())({list:n})}else{q=_.template($("#search-scroll-list-tpl").html())({listClass:l,list:n})}e.append(q);if(l==="ringtone-search-list"){window.player.bindEvents()}h.focus();b=e.find(".scroller");var s=b.closest(".scroller-wrap"),p=b.find("ul"),o=p.find(".list-loader"),r=true;b.customScroll({onSelect:function(u){var t="";if(m==="ringtone"){if(u.originalEvent){u.stopPropagation()}else{t=$(this).find("a.track-name").attr("href")}}else{t=$(this).find("a").first().attr("href")}if(t){window.preloader();window.location.href=t}},scrollbarMinHeight:100});$(window).resize();if(_.isArray(n)&&n.length>0){d=n.length;if(d<a){r=false;p.addClass("full")}}else{p.find(".nothing-found").show()}b.on("scroll",function(){if(r){if(p.height()-b.scrollTop()-s.height()<50){r=false;$.ajax({type:"POST",url:"/xrequest/search/",data:{razdel:m,search_word:k,limit:a,offset:d},success:function(t){if(_.isArray(t)&&t.length>=a){d+=t.length;r=true}else{r=false;p.addClass("full")}var u="";for(var w in t){if(l==="ringtone-search-list"){u+=_.template($("#ringtone-track-tpl").html())({item:t[w]})}else{var v=l!=="picture-search-list"?t[w]["title"]:('<div class="title">'+t[w]["title"]+'</div><div class="image-count">'+t[w]["img_count"]+"</div>");var x='<div class="image'+(l!=="picture-search-list"?" pop-real-image":"")+'"><div class="image-wrapper"><img src="'+t[w]["img"]+'"/></div></div>';u+='<li tabindex="0"><a href="'+t[w]["url"]+'" class="item-wrapper">'+x+'<div class="info">'+v+"</div></a></li>"}}o.before(u);b.customScroll("update");if(l==="ringtone-search-list"){window.player.bindEvents()}},dataType:"json"})}}})},error:function(n){},complete:function(){e.removeClass("loading")},dataType:"json"})},300));var c=function(){var k=$(window),l=k.height();b.css({"max-height":(l<525?320:(l-185<570?l-185:570))+"px"});b.customScroll("update")};$(window).on("resize",c)})();(function(){var u=$("#pic-gallery");if(u.length===0){return}var c=u.find(".input"),a=c.find("input"),m=$("#main-image"),t=m.data("imageId"),k=m.data("imageEr"),f=$("#image-list-wrapper"),p=f.find("ul"),g=f[0],d=u.find(".scroll-left-button"),b=u.find(".scroll-right-button"),l=$(window),r=$(document);var i={};var n=function(){var w=c.find(".positioning-wrap"),z=0,v=this;a.on("focus mousedown",function(){$(".input").not(c).removeClass("open");c.addClass("open")});a.on("mousedown",function(){a.val("").attr("value","");c.find(".clear-input").hide();c.find(".arrow-up-small").css("display","inline-block")});r.on("mousedown",function(){a.val(a.attr("data-default"));c.find(".clear-input").hide();y()});var y=function(){x();c.removeClass("loading full");c.append(w);c.find(".scroller").customScroll("update")};var x=function(){if(w[0]&&$.contains(document.documentElement,w[0])){w.detach()}else{c.find(".positioning-wrap").remove()}};this.adjustPosition=function(){var D=c[0].getBoundingClientRect().bottom-c[0].getBoundingClientRect().height,B=l.height()-c[0].getBoundingClientRect().bottom,C=c.find(".positioning-wrap"),A=C.height();C.toggleClass("ontop",B<A&&A<D)};a.on("input",function(){var A=a.val();if(!A){y()}else{c.addClass("loading")}});c.on("initCustomScroll",function(){var A=c.find(".scroller");A.customScroll({onSelect:function(){var B=$(this),C=B.text(),D=B.data("id");a.attr("data-default",C);a.val(C);y();$.cookie("tags",'["'+D+'"]');$.cookie("color","");i=new o({from:0})},onInput:function(){if(a.val()){c.find(".arrow-up-small").hide()}else{c.find(".arrow-up-small").show()}},onClear:function(){y()},onBlur:function(){c.find(".arrow-up-small").hide()},onFocus:function(){c.find(".arrow-up-small").show()},scrollbarMinHeight:100}).customScroll("update");v.adjustPosition()});a.on("input",_.debounce(function(){var A=a.val();$.ajax({type:"POST",url:"/xrequest/search",data:{razdel:"pic_no_images",search_word:A,limit:20,offset:0},success:function(B){x();var F=_.template($("#search-scroll-list-tpl").html())({listClass:"pic-tag-search-list",list:B});c.append(F);c.trigger("initCustomScroll");var G=c.find(".scroller"),H=G.closest(".scroller-wrap"),D=G.find("ul"),C=D.find(".list-loader"),E=true;if(_.isArray(B)&&B.length>0){z=B.length;if(z<20){E=false;D.addClass("full")}}else{D.find(".nothing-found").show()}G.on("scroll",function(){if(E){if(D.height()-G.scrollTop()-H.height()<50){E=false;$.ajax({type:"POST",url:"/xrequest/search",data:{razdel:"pic_no_images",search_word:A,limit:10,offset:z},success:function(I){if(_.isArray(I)&&I.length>=10){z+=I.length;E=true}else{E=false;D.addClass("full")}var J="";for(var K in I){J+='<li tabindex="0" data-id="'+I[K]["id"]+'" data-src="'+I[K]["src"]+'"><span>'+I[K]["title"]+"</span></li>"}C.before(J);G.customScroll("update")},error:function(){},dataType:"json"})}}})},error:function(B){},complete:function(){c.removeClass("loading")},dataType:"json"})},200));c.trigger("initCustomScroll")};var o=function(K){K=_.extend({from:0,step:79,timeAR:100,timeSR:200},K);var C=0,B=1,F=2,z=158,w=6;var G=this,H=[],E={left:true,right:true},x=false,D={left:true,right:true};var J=$.cookie("tags")?JSON.parse($.cookie("tags")):"",y=$.cookie("color")||"",v=$.cookie("sort");var A=function(){return(H.length*z-37-f.scrollLeft()-g.offsetWidth)/z};var I=function(){return parseInt(f.scrollLeft())/z};this.updatePicList=function(){if(E.left&&I()<w){G.load({loadMode:B,from:H[0]});return}if(E.right&&A()<w){G.load({loadMode:F,from:H[H.length-1]});return}if(I()>0){D.left=true;d.css("visibility","visible")}else{D.left=false;d.css("visibility","hidden")}if(A()>0){D.right=true;b.css("visibility","visible")}else{D.right=false;b.css("visibility","hidden")}};this.load=function(L){L=_.extend({loadMode:0,from:0,tags:J,color:y,sortMode:v},L);if(x===true){return}x=true;$.ajax({type:"POST",url:"getImageList",data:{loadMode:L.loadMode,from:L.from,tags:L.tags,color:L.color,sortMode:L.sortMode,isErotic:k},success:function(O){if(O.length===0||!_.isArray(O)){if(L.loadMode===1){E.left=false}if(L.loadMode===2){E.right=false}return}var N="",Q=[];for(var P in O){Q.push(O[P]["id"]);N+=_.template($("#pic-gallery-slider-item-tpl").html())({id:O[P]["id"],src:O[P]["src"],blurSuffix:O[P]["blurSuffix"],imgClass:O[P]["id"]==t?" active":""})}if(!N){return}switch(L.loadMode){case C:H=Q;var M=H.indexOf(L.from.toString());if(M<8){E.left=false}u.addClass("loaded");p.empty();p.append(N);f.scrollLeft((M-1)*z);break;case F:if(Q.length===0){E.right=false}else{H=H.concat(Q);p.append(N)}break;case B:if(Q.length===0){E.left=false}else{H=Q.concat(H);p.prepend(N);f.scrollLeft(f.scrollLeft()+Q.length*z)}break}x=false;G.updatePicList()},error:function(){x=false},dataType:"json"})};this.scroll=function(L){if(!D.left&&!D.right){return}var M=null;if(L.deltaY){M=L.deltaY}else{if(L.wheelDelta){M=L.wheelDelta}}if(M){f.scrollLeft(f.scrollLeft()-M*K.step);if(M<0){if(A()>0){b.addClass("active");clearTimeout(G.wD0);G.wD0=setTimeout(function(){b.removeClass("active")},K.timeAR)}}else{if(I()>0){d.addClass("active");clearTimeout(G.wD1);G.wD1=setTimeout(function(){d.removeClass("active")},K.timeAR)}}G.updatePicList()}};this.scrollLeft=function(L){L.preventDefault();G.scroll({wheelDelta:-1});G.sT=setTimeout(function(){b.mousedown()},K.timeSR);r.on("mouseup.slider",G.scrollClear)};this.scrollRight=function(L){L.preventDefault();G.scroll({wheelDelta:1});G.sT=setTimeout(function(){d.mousedown()},K.timeSR);r.on("mouseup.slider",G.scrollClear)};this.scrollClear=function(){clearTimeout(G.sT);r.off("mouseup.slider")};p.empty();this.load({from:K.from})};var q=function(){var w=$.cookie("panel_history"),v=null;if(!_.isEmpty(w)){w=JSON.parse(w);if(_.isArray(w)){v=w[0]}}v||(v={});return !!v.screen};var j=function(){var y=$("#phone-panel"),v=y.attr("class"),x=$.jPopup({onBeforeClose:function(){y.attr("class",v);$("#phone-panel-block").append(y)}});y.attr("class","phone-panel none-selected edited");var w=$(_.template($("#phone-panel-popup-tpl").html())({})).append(y);x.setContent(w);y.find(".input-block.phone .scroller").customScroll("update")};var s=function(){var w=$("#zumchik"),v=this;this.getDownloadUrl=function(){var B=w.zumchik("params"),A=B.scale?parseFloat(B.scale):1,y=B.leftTop||{left:0,top:0},x=B.rightBottom||{right:0,bottom:0},z="downloadImage?id="+parseInt(t);z+="&l="+parseInt(y.left);z+="&t="+parseInt(y.top);z+="&r="+parseInt(x.right);z+="&b="+parseInt(x.bottom);z+="&s="+A;return z};this.downloadImage=function(){if(q()){$.ajax({type:"POST",url:"downloadImage",data:{id:t},success:function(x){if(x){window.location=v.getDownloadUrl()}}})}else{j()}};this.getQrCodePopup=function(x){if(q()){var y=encodeURIComponent(v.getDownloadUrl());$.ajax({type:"POST",url:"/Xrequest/getQRHash",data:{data:y},success:function(){var A=_.template($("#qr-popup-tpl").html())({url:x+y});var z=$.jPopup({content:A})}})}else{j()}return false};this.getImageParams=function(){var x={};x.x=parseFloat(w.data("x"))*100;x.y=parseFloat(w.data("y"))*100;if(_.isNaN(x.x)||_.isNaN(x.x)||x.x<0||x.x>100||x.y<0||x.y>100||(x.x==0&&x.y==0)){x={}}return x};w.zumchik(this.getImageParams())};var h=new s();var e=new n();var i=new o({from:t});$("#download-image").on("mousedown",function(){h.downloadImage()});f.on("mousewheel",function(v){v.preventDefault()});f.on("mousewheel",_.throttle(function(v){i.scroll(v)},50));d.on("mousedown",function(v){i.scrollRight(v)});b.on("mousedown",function(v){i.scrollLeft(v)});l.on("resize",function(){i.updatePicList();e.adjustPosition()});r.on("scroll",function(){e.adjustPosition()});$("#get-pic-qr-code").on("click",function(w){w.preventDefault();var v=$(this).data("url");h.getQrCodePopup(v)})})();(function(){var a={go:function(c,b){var d=a,f=function(g){return $("meta[name=og\\:"+g+"]").attr("content")},e=$.extend({type:"vk",url:f("url"),count_url:f("url"),title:f("title"),image:f("image"),text:f("description"),},$(c).data(),b);if(d.popup(link=d[e.type](e))===null){window.location=link;return false}else{return false}},vk:function(b){var c=$.extend({url:location.href,title:document.title,image:"",text:"",},b);return"http://vkontakte.ru/share.php?url="+encodeURIComponent(c.url)+"&title="+encodeURIComponent(c.title)+"&description="+encodeURIComponent(c.text)+"&image="+encodeURIComponent(c.image)+"&noparse=true"},ok:function(b){var c=$.extend({url:location.href,text:"",},b);return"http://www.ok.ru/dk?st.cmd=addShare&st.s=1&st._surl="+encodeURIComponent(c.url)+"&st.comments="+encodeURIComponent(c.text)},fb:function(b){var c=$.extend({url:location.href,title:document.title,image:"",text:"",},b);return"http://www.facebook.com/sharer.php?s=100&p[title]="+encodeURIComponent(c.title)+"&p[summary]="+encodeURIComponent(c.text)+"&p[url]="+encodeURIComponent(c.url)+"&p[images][0]="+encodeURIComponent(c.image)},tw:function(b){var c=$.extend({url:location.href,count_url:location.href,title:document.title,},b);return"http://twitter.com/share?text="+encodeURIComponent(c.title)+"&url="+encodeURIComponent(c.url)+"&counturl="+encodeURIComponent(c.count_url)},gplus:function(b){var c=$.extend({url:location.href},b);return"https://plus.google.com/share?url="+encodeURIComponent(c.url)},popup:function(b){return window.open(b,"","width=626,height=436")}};$(".share-link").on("click",function(){a.go(this)})})();(function(){var u=$("#theme-gallery");if(u.length===0){return}var e=u.find(".input"),a=e.find("input"),p=$("#main-image"),t=p.data("imageId"),l=p.data("imageEr"),g=$("#image-list-wrapper"),r=g.find("ul"),h=g[0],f=u.find(".scroll-left-button"),c=u.find(".scroll-right-button"),n=$(window),s=$(document);var o={};var i=$("#gallery-slider"),q=i.data("resolution"),k=i.data("osUrl"),b=i.data("initialGenre");var d=function(){var z=0,y=e.find(".scroller"),w=y.find("li"),x=e.find(".nothing-found"),v=this;a.on("focus mousedown",function(){$(".input").not(e).removeClass("open");e.addClass("open")});a.on("mousedown",function(){a.val("").attr("value","");e.find(".arrow-up-small").css("display","inline-block")});s.on("mousedown",function(){a.val(a.attr("data-default"));e.find(".clear-input").hide();w.removeClass("hidden");y.customScroll("update");x.addClass("hidden")});this.adjustPosition=function(){var D=e[0].getBoundingClientRect().bottom-e[0].getBoundingClientRect().height,B=n.height()-e[0].getBoundingClientRect().bottom,C=e.find(".positioning-wrap"),A=C.height();C.toggleClass("ontop",B<A&&A<D)};e.on("initCustomScroll",function(){y.customScroll({onSelect:function(){var A=$(this),B=A.text();b=A.data("src");a.attr("data-default",B);a.val(B);o=new j({genre:b})},onInput:function(){var A=$.trim(a.val());w.each(function(C,D){var B=$(D);B.toggleClass("hidden",!new RegExp("^"+A,"i").test($.trim(B.text())))});x.toggleClass("hidden",w.not(".hidden").length>0);y.customScroll("update");if(a.val()){e.find(".arrow-up-small").hide()}else{e.find(".arrow-up-small").show()}},onBlur:function(){e.find(".arrow-up-small").hide()},onFocus:function(){e.find(".arrow-up-small").show()},scrollbarMinHeight:100}).customScroll("update");v.adjustPosition()});e.trigger("initCustomScroll")};var j=function(I){I=_.extend({initialId:0,step:79,timeAR:100,timeSR:200},I);var B="init",A="left",E="right",y=158,w=6;var F=this,G=[],D={left:true,right:true},x=false,C={left:true,right:true};var v=$.cookie("sort");var z=function(){return(G.length*y-37-g.scrollLeft()-h.offsetWidth)/y};var H=function(){return parseInt(g.scrollLeft())/y};this.updateThemeList=function(){if(D.left&&H()<w){F.load({action:A,initialId:G[0]});return}if(D.right&&z()<w){F.load({action:E,initialId:G[G.length-1]});return}if(H()>0){C.left=true;f.css("visibility","visible")}else{C.left=false;f.css("visibility","hidden")}if(z()>0){C.right=true;c.css("visibility","visible")}else{C.right=false;c.css("visibility","hidden")}};this.load=function(J){J=_.extend({action:B,initialId:0,genre:b,sortMode:v,criteria:k,screenWidth:$(window).width()},J);if(x===true){return}x=true;$.ajax({type:"POST",url:"/ajax/getThemesList",data:{action:J.action,initialId:J.initialId,genre:J.genre,resolution:q,criteria:J.criteria,screenWidth:J.screenWidth,sortMode:J.sortMode},success:function(N){var L=N.data||[];if(L.length===0||!_.isObject(L)){if(J.action===E){D.right=false}if(J.action===A){D.left=false}return}var M="",Q=[],O=N.listHeight?N.listHeight:(N.height&&N.width?Math.round(111*N.height/N.width):null);for(var P in L){Q.push(L[P]["id"]);M+=_.template($("#theme-gallery-slider-item-tpl").html())({pageUrl:L[P]["link"],imgUrl:L[P]["img"],imgClass:L[P]["id"]==t?" active":"",width:111,height:O})}if(!M){return}switch(J.action){case B:G=Q;var K=G.indexOf(J.initialId.toString());u.addClass("loaded");r.empty();r.append(M);if(K!==-1){g.scrollLeft((K-1)*y)}break;case E:if(Q.length===0){D.right=false}else{G=G.concat(Q);r.append(M)}break;case A:if(Q.length===0){D.left=false}else{G=Q.concat(G);r.prepend(M);g.scrollLeft(g.scrollLeft()+Q.length*y)}break}x=false;F.updateThemeList()},error:function(){x=false},dataType:"json"})};this.scroll=function(J){if(!C.left&&!C.right){return}var K=null;if(J.deltaY){K=J.deltaY}else{if(J.wheelDelta){K=J.wheelDelta}}if(K){g.scrollLeft(g.scrollLeft()-K*I.step);if(K<0){if(z()>0){c.addClass("active");clearTimeout(F.wD0);F.wD0=setTimeout(function(){c.removeClass("active")},I.timeAR)}}else{if(H()>0){f.addClass("active");clearTimeout(F.wD1);F.wD1=setTimeout(function(){f.removeClass("active")},I.timeAR)}}F.updateThemeList()}};this.scrollLeft=function(J){J.preventDefault();F.scroll({wheelDelta:-1});F.sT=setTimeout(function(){c.mousedown()},I.timeSR);s.on("mouseup.slider",F.scrollClear)};this.scrollRight=function(J){J.preventDefault();F.scroll({wheelDelta:1});F.sT=setTimeout(function(){f.mousedown()},I.timeSR);s.on("mouseup.slider",F.scrollClear)};this.scrollClear=function(){clearTimeout(F.sT);s.off("mouseup.slider")};r.empty();this.load({initialId:I.initialId})};$(".thumb").on("click",function(){p.attr("src",$(this).attr("src").replace(/\/small\//i,"/real/"))});$("#download-theme").on("click",function(){$("#download-form").submit()});var m=new d();var o=new j({initialId:t});$("#download-image").on("mousedown",function(){photoEditor.downloadImage()});g.on("mousewheel",function(v){v.preventDefault()});g.on("mousewheel",_.throttle(function(v){o.scroll(v)},50));f.on("mousedown",function(v){o.scrollRight(v)});c.on("mousedown",function(v){o.scrollLeft(v)});n.on("resize",function(){o.updateThemeList();m.adjustPosition()});s.on("scroll",function(){m.adjustPosition()});$("#get-pic-qr-code").on("click",function(w){w.preventDefault();var v=$("#download-form").attr("action");$.ajax({type:"POST",url:"/Xrequest/getQRHash",data:{data:v},success:function(){var y=_.template($("#qr-popup-tpl").html())({url:v});var x=$.jPopup({content:y})}})})})();(function(){var b=$("#publishers");if(b.length===0){return}var a=$('<div id="buttons-mask"><div id="button-close"><i class="sprite i-51 close-white"></i></div></div>');var d=$(window);b.find(".show-screenshot").on("click",function(){var g=d.width()-120,e=0.846*g;if(g>996){g=996;e=843}var f=$.jPopup({content:'<img width="'+g+'" height="'+e+'" src="'+$(this).data("src")+'">',activeMask:a});$("#popup").on("click",function(){f.close()});$(window).resize()});b.find(".jump").on("click",function(f){f.preventDefault();var g=$(this).data("href");$("html, body").animate({scrollTop:$("#"+g).offset().top-20},"slow")});var c=function(p){var h=b.data("popupData")[p.type],l=_.template($("#publishers-popup-tpl").html())({data:h}),f=$.jPopup({content:l,verticalAlign:"middle"}),e=$("#popup"),j=$("#publishers-popup"),o=j.find('input[name="subject"]'),k=j.find('input[name="email"]'),g=j.find('textarea[name="text"]'),m=k.data("invalid"),n=o.data("invalid"),i=g.data("invalid");e.find(".close").on("click",function(){f.close()});e.find(".send").on("click",function(){var q=$.trim(k.val()),r=$.trim(o.val()),v=$.trim(g.val()),s=true;if(_.isEmpty(r)){o.errorTooltip(n).closest(".error-container").addClass("error");if(s){s=false;o.focus()}}if(_.isEmpty(v)){g.errorTooltip(i).closest(".error-container").addClass("error");if(s){s=false;g.focus()}}if(_.isEmpty(q)||!_.isString(q)||!q.match(/^\w+([.-]\w+)*@\w+([.-]?\w+)*(\.\w{2,4})+$/)){k.errorTooltip(m).closest(".error-container").addClass("error");if(s){k.focus();s=false}}if(s){var u='<div class="feedback-popup loading" id="feedback-popup"><div class="loader-image preloader-gif"></div></div>';f.setContent(u);j.one("response.publish",function(){f.setContent(u);e.find(".popup-close").one("click",function(){f.close()})});var t=": "+r+"\n";t+=": "+v;$.ajax({type:"POST",dataType:"text",url:"/xrequest/sendFeedback",data:{type:h.type,email:q,text:t},success:function(){j.submit();u=$("#publishers-popup-ok-tpl").html()},error:function(){u=$("#publishers-popup-error-tpl").html()},complete:function(){j.trigger("response.publish")}})}});j.find('input[name="subject"], input[name="email"], textarea[name="text"]').on("input paste",function(){var q=$(this);q.errorTooltip("remove");q.closest(".error-container").removeClass("error")})};b.find(".order-btn").on("click",function(g){g.preventDefault();var f=$(this).data("type");new c({type:f})})})();(function(){var a=function(j){var h=$("#feedback-tpl").html(),c=$.jPopup({content:h,verticalAlign:"middle"}),b=$("#popup"),e=$("#feedback-popup"),g=e.find('input[name="email"]'),f=e.find('textarea[name="text"]'),d=e.find('.type input[type="radio"]'),i=d.closest(".radio");if(j.advertise){$("#proposal-r").prop("checked",true)}e.find(".send").on("click",function(){var k=$.trim(g.val()),o=g.data("invalid"),n=d.filter(":checked"),m=n.length!==0?n.first().val():"",q=$.trim(f.val()),p=f.data("invalid"),l=true;if(!m){i.addClass("error");l=false}if(_.isEmpty(k)||!_.isString(k)||!k.match(/^\w+([.-]\w+)*@\w+([.-]?\w+)*(\.\w{2,4})+$/)){g.errorTooltip(o).closest(".error-container").addClass("error");if(l){g.focus();l=false}}if(_.isEmpty(q)){f.errorTooltip(p).closest(".error-container").addClass("error");if(l){l=false;f.focus()}}if(l){c.setContent('<div class="feedback-popup loading" id="feedback-popup"><div class="loader-image preloader-gif"></div></div>');$.ajax({type:"POST",dataType:"text",url:"/xrequest/sendFeedback",data:{type:m,email:k,text:q},success:function(){h=_.template($("#feedback-ok-tpl").html())({email:k})},error:function(){h=$("#feedback-error-tpl").html()},complete:function(){b.trigger("response")}})}});e.find('input[name="email"], textarea[name="text"]').on("input paste",function(){var k=$(this);k.errorTooltip("remove");k.closest(".error-container").removeClass("error")});e.find(".close").on("click",function(){c.close()});d.one("change",function(){i.removeClass("error")});b.on("response.feedback",function(){c.setContent(h)})};$("#feedback").on("click",function(b){b.preventDefault();new a({})});$(".advertise-link").on("click",function(b){new a({advertise:true})})})();(function(){var c=$("#question-form");if(c.length===0){return}var b=c.find('input[name="email"]'),a=c.find('textarea[name="text"]');c.find(".send").on("click",function(){var e=$.trim(b.val()),g=b.data("invalid"),j=$.trim(a.val()),h=a.data("invalid"),f=true;if(_.isEmpty(e)||!_.isString(e)||!e.match(/^\w+([.-]\w+)*@\w+([.-]?\w+)*(\.\w{2,4})+$/)){b.errorTooltip(g).closest(".error-container").addClass("error");if(f){b.focus();f=false}}if(_.isEmpty(j)){a.errorTooltip(h).closest(".error-container").addClass("error");if(f){f=false;a.focus()}}if(f){var d=$.jPopup({content:'<div class="feedback-popup loading" id="feedback-popup"><div class="loader-image preloader-gif"></div></div>',verticalAlign:"middle"}),i=$("#popup");$.ajax({type:"POST",dataType:"text",url:"/xrequest/sendFeedback",data:{type:2,email:e,text:j},success:function(){b.val("");a.val("");content=_.template($("#feedback-ok-tpl").html())({email:e})},error:function(){content=$("#feedback-error-tpl").html()},complete:function(){i.trigger("response")}});i.on("response.feedback",function(){d.setContent(content)})}});c.find('input[name="email"], textarea[name="text"]').on("input paste",function(){var d=$(this);d.errorTooltip("remove");d.closest(".error-container").removeClass("error")})})();